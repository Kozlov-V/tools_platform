<!DOCTYPE html>
<html>
	<head>
		<title>Johnson Tools</title>
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
		<link type="text/css" rel="stylesheet" href="/css/index.css" />
		<script type="text/javascript" src="/js/index.js"></script>
	</head>
	<body>
		<h2>Johnson Tools</h2>
			Welcome, 
			<erl>
				-include("jt.hrl").
				out(Arg) ->
					UserId = (Arg#arg.state)#arg_state.user_id,
					UserName = (Arg#arg.state)#arg_state.user_name,

					{html, UserId ++ "(" ++ UserName ++ ")"}.
			</erl>.

			<a id="about" href="#" onclick="return about();">about</a>
			<a href="/change_password.yaws">change password</a>
			<a href="/change_profile.yaws">change profile</a>
			<a id="logout" href="/user/logout">logout</a>
		</ul>
		<hr/>

		<erl>
			-include("jt.hrl").
			out(Arg) ->
				UserId = (Arg#arg.state)#arg_state.user_id,
				IsAdmin = model_user:is_admin(UserId),
				if
					IsAdmin =:= true ->
						AdminHtml = "<a href=\"/admin/setting.yaws\">setting</a>"
									" <a href=\"/admin/user.html\">users</a>"
									"<hr/>";
					true -> 
						AdminHtml = ""
				end,
				{html, AdminHtml}.
		</erl>

		<div id="content">
			<ul>
				<erl>
				-include("jt.hrl").
				out(Arg) ->
					UserId = (Arg#arg.state)#arg_state.user_id,
					NoteEnabled = model_user_preference:get(UserId, ?USER_PREFERENCE_NOTE_ENABLED),
					WordEnabled = model_user_preference:get(UserId, ?USER_PREFERENCE_WORD_ENABLED),
					GalleryEnabled = model_user_preference:get(UserId, ?USER_PREFERENCE_GALLERY_ENABLED),
					if
						NoteEnabled =:= true ->
							NoteHtml = "<li class=\"tool\"><a href=\"/note.html\">note</a></li>";
						true -> 
							NoteHtml = ""
					end,
					if
						WordEnabled =:= true ->
							WordHtml = "<li class=\"tool\"><a href=\"/word.yaws\">word</a></li>";
						true -> 
							WordHtml = ""
					end,
					if
						GalleryEnabled =:= true ->
							GalleryHtml = "<li class=\"tool\"><a href=\"/gallery.html\">gallery</a></li>";
						true -> 
							GalleryHtml = ""
					end,
					Html = NoteHtml ++ WordHtml ++ GalleryHtml,
					{html, Html}.
				</erl>
			</ul>
			<erl>
				-include("jt.hrl").
				out(Arg) ->
					UserId = (Arg#arg.state)#arg_state.user_id,
					SportEnabled = model_user_preference:get(UserId, ?USER_PREFERENCE_SPORT_ENABLED),
					if
						SportEnabled =:= true ->
							Html = "<ul style=\"display:block;\">";
						true -> 
							Html = "<ul style=\"display:none;\">"
					end,
					{html, Html}.
			</erl>
				<li>sports index, 
				counter: <span class="sportIndex">				
					<erl>
					-include("jt.hrl").
					out(Arg) ->
						UserId = (Arg#arg.state)#arg_state.user_id,
						Html = erlang:integer_to_list(rest_sport:sport_index_counter(UserId)) ++ "%",
						{html, Html}.
					</erl>
				</span>
				timer: <span class="sportIndex">				
					<erl>
						-include("jt.hrl").
						out(Arg) ->
							UserId = (Arg#arg.state)#arg_state.user_id,
							Html = erlang:integer_to_list(rest_sport:sport_index_timer(UserId)) ++ "%",
							{html, Html}.
					</erl>
				</span></li>
			</ul>
		</div>
	</body>
</html>
